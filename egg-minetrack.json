{
  "_comment": "DO NOT EDIT: FILE GENERATED AUTOMATICALLY BY PTERODACTYL PANEL - PTERODACTYL.IO",
  "meta": {
    "version": "PTDL_v2",
    "update_url": null
  },
  "exported_at": "2024-12-09T00:00:00+00:00",
  "name": "Minetrack",
  "author": "admin@example.com",
  "description": "Minetrack is a Minecraft server tracker that lets you focus on the basics. Track player counts across multiple Minecraft servers with a beautiful web interface and historical graphs.",
  "features": null,
  "docker_images": {
    "ghcr.io/parkervcp/yolks:nodejs_18": "ghcr.io/parkervcp/yolks:nodejs_18",
    "ghcr.io/parkervcp/yolks:nodejs_20": "ghcr.io/parkervcp/yolks:nodejs_20",
    "ghcr.io/parkervcp/yolks:nodejs_21": "ghcr.io/parkervcp/yolks:nodejs_21"
  },
  "file_denylist": [],
  "startup": "rm -rf dist; if [ ! -d node_modules/winston ]; then echo 'Installing dependencies...' && npm install --build-from-source; fi; echo 'Building frontend...' && npm run build; node main.js",
  "config": {
    "files": "{\r\n    \"config.json\": {\r\n        \"parser\": \"json\",\r\n        \"find\": {\r\n            \"site.port\": \"{{server.build.default.port}}\",\r\n            \"site.ip\": \"0.0.0.0\",\r\n            \"logToDatabase\": \"{{env.LOG_TO_DATABASE == 'true' ? true : false}}\"\r\n        }\r\n    }\r\n}",
    "startup": "{\r\n    \"done\": \"Started on\"\r\n}",
    "logs": "{}",
    "stop": "^C"
  },
  "scripts": {
    "installation": {
      "script": "#!/bin/bash\napt-get update\napt-get install -y git curl build-essential python3 ca-certificates\n\ncd /mnt/server\n\necho \"Installing Node.js...\"\ncurl -fsSL https://deb.nodesource.com/setup_20.x | bash -\napt-get install -y nodejs\n\necho \"Node version: $(node -v)\"\necho \"NPM version: $(npm -v)\"\n\nif [ \"${USER_UPLOAD}\" == \"false\" ] || [ \"${USER_UPLOAD}\" == \"0\" ]; then\n    echo \"Cloning repository...\"\n    if [ -d \".git\" ]; then\n        git pull\n    else\n        git clone ${GIT_REPO} .\n    fi\n    \n    if [ -n \"${GIT_BRANCH}\" ]; then\n        git checkout ${GIT_BRANCH}\n    fi\nfi\n\nif [ -f \"package.json\" ]; then\n    echo \"Installing dependencies...\"\n    npm install --build-from-source\n    \n    echo \"Building frontend...\"\n    npm run build || echo \"Build step skipped or failed\"\nfi\n\nif [ ! -f \"config.json\" ]; then\n    echo \"Creating default config.json...\"\n    cat > config.json << 'CONFIGEOF'\n{\n    \"site\": {\n        \"port\": 8080,\n        \"ip\": \"0.0.0.0\"\n    },\n    \"rates\": {\n        \"pingAll\": 3000,\n        \"connectTimeout\": 2500\n    },\n    \"oldPingsCleanup\": {\n        \"enabled\": false,\n        \"interval\": 3600000\n    },\n    \"logFailedPings\": true,\n    \"logToDatabase\": true,\n    \"database\": {\n        \"type\": \"sqlite\",\n        \"sqlite\": {\n            \"filename\": \"database.sql\"\n        }\n    },\n    \"graphDuration\": 86400000,\n    \"serverGraphDuration\": 180000,\n    \"trustProxy\": false,\n    \"allowedOrigins\": [],\n    \"connectionLimits\": {\n        \"maxPerIp\": 20,\n        \"maxTotal\": 500\n    },\n    \"wsRateLimits\": {\n        \"maxMessagesPerWindow\": 10,\n        \"windowMs\": 60000\n    },\n    \"wsMaxPayload\": 1024,\n    \"httpTimeout\": 30000,\n    \"httpHeadersTimeout\": 10000,\n    \"httpKeepAliveTimeout\": 5000\n}\nCONFIGEOF\nfi\n\nif [ ! -f \"servers.json\" ]; then\n    echo \"Creating default servers.json...\"\n    cat > servers.json << 'SERVERSEOF'\n[\n    {\n        \"name\": \"Hypixel\",\n        \"ip\": \"mc.hypixel.net\",\n        \"type\": \"PC\"\n    },\n    {\n        \"name\": \"CubeCraft\",\n        \"ip\": \"play.cubecraft.net\",\n        \"type\": \"PC\"\n    }\n]\nSERVERSEOF\nfi\n\necho \"\"\necho \"Installation complete!\"\necho \"Files in directory:\"\nls -la",
      "container": "ghcr.io/parkervcp/installers:debian",
      "entrypoint": "bash"
    }
  },
  "variables": [
    {
      "name": "Git Repository",
      "description": "The Git repository to clone Minetrack from.",
      "env_variable": "GIT_REPO",
      "default_value": "https://github.com/Cryptkeeper/Minetrack.git",
      "user_viewable": true,
      "user_editable": true,
      "rules": "required|string",
      "field_type": "text"
    },
    {
      "name": "Git Branch",
      "description": "The branch to checkout after cloning. Leave empty for default branch.",
      "env_variable": "GIT_BRANCH",
      "default_value": "",
      "user_viewable": true,
      "user_editable": true,
      "rules": "nullable|string",
      "field_type": "text"
    },
    {
      "name": "User Upload",
      "description": "Set to true/1 if you want to upload your own files instead of cloning from Git.",
      "env_variable": "USER_UPLOAD",
      "default_value": "false",
      "user_viewable": true,
      "user_editable": true,
      "rules": "required|string|in:true,false,0,1",
      "field_type": "text"
    },
    {
      "name": "Ping Interval",
      "description": "How often to ping servers in milliseconds (default: 3000 = 3 seconds).",
      "env_variable": "PING_INTERVAL",
      "default_value": "3000",
      "user_viewable": true,
      "user_editable": true,
      "rules": "required|integer|min:1000",
      "field_type": "text"
    },
    {
      "name": "Graph Duration",
      "description": "How long to keep graph data in milliseconds (default: 86400000 = 24 hours).",
      "env_variable": "GRAPH_DURATION",
      "default_value": "86400000",
      "user_viewable": true,
      "user_editable": true,
      "rules": "required|integer|min:3600000",
      "field_type": "text"
    },
    {
      "name": "Log to Database",
      "description": "Whether to log ping data to the database for historical graphs (true/false).",
      "env_variable": "LOG_TO_DATABASE",
      "default_value": "true",
      "user_viewable": true,
      "user_editable": true,
      "rules": "required|string|in:true,false",
      "field_type": "text"
    }
  ]
}

